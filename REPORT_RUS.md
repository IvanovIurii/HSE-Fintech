# Отчёт о построении механической торговой системы на основе индикатора ROC

## 1. Введение

Этот отчёт представляет собой описание процесса построения и оптимизации механической торговой системы (МТС),
использующей индикатор технического анализа **Rate of Change (ROC)** для торговли на фондовом рынке. Для анализа выбран
актив — акции **Apple (AAPL)** (стратегия не зависит от выбора инструмента или компании), а для тестирования
используется исторический ряд данных с интервалом в **дневной
таймфрейм** (daily timeframe / "дневка") за период с **1 января 2022 года по 31 декабря 2024 года**.
Почему был выбран этот период? Мне хотелось посмотреть, как на акции популярной западной компании отразились события и
кризис начала 22 года. И как можно было на этом заработать.

Основная цель — разработка торговой системы с обоснованием выбора параметров и методов оптимизации, а также проведение
тестирования и анализа качества стратегии.

## 2. Выбор инструмента и актива

### Актив:

В качестве актива для тестирования торговой стратегии выбраны акции компании **Apple (AAPL)**. Этот актив был выбран
из-за его высокой ликвидности и значительного исторического объёма торгов, что делает его подходящим для тестирования
торговых стратегий.

### Таймфрейм:

Для анализа был выбран **дневной таймфрейм** (daily), поскольку он даёт достаточную информацию для более стабильного
анализа и принятия решений по покупке/продаже. Также я в основном использую именно такой невной таймфрейм.

### Данные:

Для тестирования использовался CSV-файл с историческими данными для акций **Apple**, который включает информацию о дате,
цене открытия, максимальной и минимальной цене за день, цене закрытия и объёме торгов.

## 3. Методика построения торговой системы

Механическая торговая система (МТС) была построена с использованием индикатора **Rate of Change (ROC)**. Этот индикатор
измеряет процентное изменение цены актива за определённый период времени и является важным инструментом для выявления
трендов.

Система была написана с нуля использую язык программирования Python.

### 3.1. Метод изолированности входа/выхода

Торговая система основывается на методе **изолированности входа/выхода**, что означает, что покупки и продажи происходят
только по заранее определённым сигналам индикатора ROC. В данной системе:

- **Сигнал на покупку** возникает, когда ROC становится положительным, указывая на начало восходящего тренда.
- **Сигнал на продажу** возникает, когда ROC становится отрицательным, что сигнализирует о возможном падении тренда.

Кроме того, для повышения надежности сигналов использован принцип **задержки**: покупка и продажа происходят **через 2
бара после сигнала**. Это помогает избежать слишком быстрых реакций на краткосрочные колебания рынка.

### 3.2. Выбор индикатора

Индикатор **Rate of Change (ROC)** был выбран в качестве основного инструмента технического анализа для создания
торговой системы, поскольку:

- Он хорошо показывает **темп изменения цены** за определённый промежуток времени.
- ROC позволяет выявить **направление тренда** (восходящий или нисходящий), что идеально подходит для краткосрочной
  торговли.
- Индикатор достаточно прост в использовании и не требует сложных настроек.

### 3.3. Определение оптимальных параметров

Для вычисления ROC используется параметр — **размер окна** (ROC window). В ходе оптимизации параметра окна было
протестировано несколько значений, начиная от 10 до 30 дней, чтобы найти наиболее эффективное значение для анализа акций
AAPL в рамках выбранного таймфрейма.

## 4. Этапы и результаты построения торговой системы

### 4.1. Первый метод: Изолированность входа/выхода с использованием ROC

1. **Шаг 1**: Сбор исторических данных по акции AAPL.
2. **Шаг 2**: Расчёт индикатора ROC для каждого дня с заданным окном (например, 14 дней).
3. **Шаг 3**: Генерация сигналов на основе значения ROC:
    - **Сигнал на покупку**: когда ROC > 0.
    - **Сигнал на продажу**: когда ROC < 0.
4. **Шаг 4**: Реализация задержки в 2 бара для каждой сделки, чтобы исключить ложные сигналы.
5. **Шаг 5**: Проведение бэктестинга с подсчётом ключевых метрик:
    - Общая прибыль.
    - Процент успешных сделок (win rate).
    - Средняя прибыль на сделку.

### 4.2. Результаты для первого метода

Пример результатов бэктестинга для стратегии с окном ROC = 14:

```
Общая прибыль: 120.55
Общее количество сделок: 45
Процент успешных сделок: 62.22%
Средняя прибыль на сделку: 2.68
Количество выигрышей: 28, количество проигрышей: 17
```

Эти результаты показывают положительное соотношение прибыли и убытков, что указывает на эффективность выбранной
стратегии.

### 4.3. Второй метод: Оптимизация параметров ROC

Во втором методе была проведена **оптимизация параметра окна ROC**. Были протестированы различные окна от 10 до 30 дней.
На основе бэктестинга было выбрано оптимальное значение **14 дней**, которое показало наибольшую общую прибыль и лучший
процент успешных сделок среди других тестируемых значений.

## 5. Оценка качества торговой системы

Для оценки качества торговой системы использовались следующие критерии:

- **Процент успешных сделок (win rate)**: Выбранная стратегия имеет **win rate 62.22%**, что является достаточно хорошим
  результатом для торговых систем. Обычно стратегию с win rate выше 50% можно считать прибыльной.
- **Общая прибыль**: Положительная общая прибыль (**120.55**) подтверждает эффективность стратегии.
- **Средняя прибыль на сделку**: Средняя прибыль на сделку составляет **2.68**, что свидетельствует о хорошем
  соотношении риска и прибыли.
- **Тестирование стратегии**: Стратегия была протестирована на исторических данных с **2022 по 2024 год** и показала
  стабильную эффективность в заданном временном диапазоне.

### Выводы:

- Торговая система, основанная на индикаторе ROC, показывает стабильную прибыль при использовании выбранного параметра
  окна (14 дней).
- Стратегия продемонстрировала хороший процент успешных сделок и положительный итоговый результат.
- Оценка параметров и оптимизация окна ROC являются важным этапом в построении эффективной торговой системы.

## 6. Заключение

В ходе работы была построена эффективная торговая система, использующая индикатор **Rate of Change (ROC)** для анализа
трендов на основе исторических данных акций **Apple (AAPL)**. Выбор параметров был обоснован через оптимизацию и
тестирование, а результаты показали положительную эффективность стратегии. Механическая торговая система
продемонстрировала хорошие результаты и может быть использована для дальнейших торговых операций при учёте рисков и
особенностей рынка.
